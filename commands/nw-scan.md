---
name: nw-scan
description: 扫描分析素材池，提取风格特征。用法: /nw-scan <pool_name>
---

# 素材池扫描命令

扫描分析参考小说素材，提取风格特征和写作模式。

## 用法

```bash
/nw-scan <pool_name>
```

## 示例

```bash
# 扫描分析名为 xuanhuan_1 的素材池
/nw-scan xuanhuan_1

# 扫描分析多个素材池
/nw-scan reference_novels
```

## 前置条件

需要先准备素材：

```bash
# 1. 创建素材目录
mkdir pools/xuanhuan_1

# 2. 放入参考小说（txt格式）
cp 斗破苍穹.txt pools/xuanhuan_1/
cp 完美世界.txt pools/xuanhuan_1/
```

## 功能

此命令会：

1. **读取素材文件**：扫描 `pools/{pool_name}/` 下的所有 txt 文件
2. **分析风格特征**：
   - 平均句长
   - 对话比例
   - 爽点密度
   - 常用词汇
3. **提取写作模式**：
   - 开篇模式
   - 章节结构
   - 钩子类型分布
4. **生成分析报告**：输出到 `pools/analysis/{pool_name}/`

## 执行流程

```
用户输入: /nw-scan xuanhuan_1
  ↓
检查素材目录:
  pools/xuanhuan_1/
  ├─ 斗破苍穹.txt (200万字)
  ├─ 完美世界.txt (300万字)
  └─ ...
  ↓
调用 pool-analyzer Skill:
  ├─ 分词统计
  ├─ 句式分析
  ├─ 爽点关键词识别
  └─ 结构模式提取
  ↓
生成报告:
  pools/analysis/xuanhuan_1/
  ├─ style-analysis.md     # 风格分析
  ├─ pattern-analysis.md   # 模式分析
  └─ style-fusion.md       # 融合风格（用于创作参考）
```

## 输出示例

```
开始分析素材池: xuanhuan_1
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📚 扫描素材文件...
  找到: 3 个文件
  总字数: 5,200,000 字

📊 分析风格特征...
  平均句长: 15.6 字
  对话比例: 43%
  爽点密度: 3.3/千字

📝 提取写作模式...
  开篇类型: 冲突开篇 (67%)
  钩子分布: 悬念型43%, 冲突型32%, 预告型15%, 反转型10%

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 分析完成!

报告位置:
pools/analysis/xuanhuan_1/
├─ style-analysis.md
├─ pattern-analysis.md
└─ style-fusion.md

下一步:
1. 查看分析报告了解风格特征
2. 生成蓝图: /nw-bp-plan xuanhuan_1 玄幻 废柴流
```

## 分析报告内容

### style-fusion.md（最重要）

融合多个参考小说的风格，生成创作参考参数：

```markdown
# 融合风格指南

## 目标参数
- 平均句长: 15.6 字
- 对话比例: 43%
- 爽点密度: 3.3/千字
- 章节字数: 2800-3200 字

## 推荐钩子类型
1. 悬念型 (43%)
2. 冲突型 (32%)
3. 预告型 (15%)
4. 反转型 (10%)

## 常用爽点关键词
- 战斗类: 碾压、秒杀、轰飞...
- 突破类: 突破、晋级、圆满...
- 震惊类: 震惊、骇然、不可思议...
```

## 错误处理

### 错误1: 素材目录不存在

```
错误: pools/xuanhuan_1 目录不存在
建议: 先创建目录并放入参考小说
  mkdir pools/xuanhuan_1
  cp 参考小说.txt pools/xuanhuan_1/
```

### 错误2: 素材目录为空

```
错误: pools/xuanhuan_1 目录中没有 txt 文件
建议: 放入至少一个参考小说文件
```

## 注意事项

1. **素材质量**：参考小说质量决定分析结果质量
2. **数量建议**：2-5 本同类型小说效果最佳
3. **格式要求**：素材文件需为 UTF-8 编码的 txt 文件
4. **可选步骤**：没有参考素材也可以直接使用 `/nw-bp-plan` 创建蓝图

## 相关命令

- `/nw-init` - 初始化工作区
- `/nw-bp-plan` - 生成蓝图

---

**提示**: 素材扫描是可选步骤，如果没有参考小说，可以直接使用 `/nw-bp-plan` 基于知识库生成蓝图。
