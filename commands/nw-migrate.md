---
name: nw-migrate
description: å‡çº§æ—§ç‰ˆé¡¹ç›®åˆ°æ–°ç‰ˆç»“æ„ã€‚ç”¨æ³•: /nw-migrate [project_id]
---

# é¡¹ç›®è¿ç§»å‘½ä»¤

å°†æ—§ç‰ˆé¡¹ç›®å‡çº§åˆ°æ–°ç‰ˆç›®å½•ç»“æ„å’Œå†…å®¹æ ¼å¼ï¼Œæ”¯æŒå¢é‡è¡¥å……éº¦åŸºæˆå‰§ç†è®ºå­—æ®µã€‚

## ç”¨æ³•

```bash
# æŒ‡å®šé¡¹ç›®
/nw-migrate xuanhuan_001

# è‡ªåŠ¨æ£€æµ‹ï¼ˆå·¥ä½œåŒºåªæœ‰ä¸€ä¸ªé¡¹ç›®æ—¶ï¼‰
/nw-migrate
```

## åŠŸèƒ½æ¦‚è¿°

æ­¤å‘½ä»¤è°ƒç”¨ `project-migrator` Agentï¼Œæ‰§è¡Œä»¥ä¸‹å‡çº§æ“ä½œï¼š

### 1. ç»“æ„å‡çº§

| æ—§ç‰ˆç»“æ„ | æ–°ç‰ˆç»“æ„ |
|----------|----------|
| `worldview.md` (å•æ–‡ä»¶) | `worldview.md` + `worldview/*.md` |
| `characters.md` (å•æ–‡ä»¶) | `characters.md` + `characters/*.md` |
| `outline.md` (å…¨éƒ¨ç« èŠ‚) | `outline.md` + `outlines/vol-*.md` |
| `chapter-001.md` (3ä½) | `chapter-0001.md` (4ä½) |

### 2. å†…å®¹å‡çº§ï¼ˆéº¦åŸºæˆå‰§ç†è®ºï¼‰

| æ–‡ä»¶ | æ–°å¢å­—æ®µ |
|------|----------|
| `outline.md` | æ§åˆ¶æ€æƒ³ã€äº”å¤§å‘½è¿è½¬æŠ˜ç‚¹ã€é€’è¿›å‹åŠ›é“¾ |
| `outlines/vol-*.md` | åœºæ™¯ææ€§ã€èŠ‚æ‹è®¾è®¡ã€æŠ‰æ‹©è®¾è®¡ |
| `characters.md` | å¯¹æŠ—åŠ›é‡è®¾è®¡ |
| `characters/*.md` | åŒå±‚æ¬²æœ›ã€å‹åŠ›äººæ ¼ã€èœ•å˜è½¨è¿¹ |
| `worldview.md` | å†²çªå±‚æ¬¡æ¡†æ¶ |

## è¿ç§»æ¨¡å¼

### æ¨¡å¼ä¸€ï¼šå®Œæ•´è¿ç§»ï¼ˆé»˜è®¤ï¼‰

```bash
/nw-migrate xuanhuan_001
```

æ‰§è¡Œæ‰€æœ‰å‡çº§æ“ä½œï¼Œé€‚åˆä¸€æ¬¡æ€§å‡çº§æ•´ä¸ªé¡¹ç›®ã€‚

### æ¨¡å¼äºŒï¼šä»…ç»“æ„

```bash
/nw-migrate xuanhuan_001 --structure-only
```

åªæ‰§è¡Œç›®å½•ç»“æ„å’Œæ–‡ä»¶å‘½åå‡çº§ï¼Œä¸ä¿®æ”¹å†…å®¹ã€‚

### æ¨¡å¼ä¸‰ï¼šä»…å†…å®¹

```bash
/nw-migrate xuanhuan_001 --content-only
```

åªè¡¥å……æˆå‰§ç†è®ºå­—æ®µï¼Œä¸æ”¹å˜æ–‡ä»¶ç»“æ„ã€‚

### æ¨¡å¼å››ï¼šé¢„è§ˆ

```bash
/nw-migrate xuanhuan_001 --dry-run
```

åªåˆ†æå·®å¼‚ï¼Œä¸æ‰§è¡Œä»»ä½•ä¿®æ”¹ï¼Œè¾“å‡ºè¿ç§»è®¡åˆ’ã€‚

## æ‰§è¡Œæµç¨‹

```
ç”¨æˆ·è¾“å…¥: /nw-migrate xuanhuan_001
  â†“
æ£€æµ‹é¡¹ç›®:
  â”œâ”€ æ£€æŸ¥ blueprints/xuanhuan_001/ æ˜¯å¦å­˜åœ¨
  â”œâ”€ æ£€æŸ¥ productions/xuanhuan_001/ æ˜¯å¦å­˜åœ¨
  â””â”€ ä¸å­˜åœ¨ â†’ æŠ¥é”™é€€å‡º
  â†“
ç‰ˆæœ¬æ£€æµ‹:
  â”œâ”€ æ£€æµ‹å½“å‰ç»“æ„ç‰ˆæœ¬
  â”œâ”€ è¯†åˆ«ç¼ºå¤±çš„ç›®å½•/æ–‡ä»¶
  â””â”€ è¯†åˆ«éœ€è¦è¡¥å……çš„å­—æ®µ
  â†“
ç”Ÿæˆè¿ç§»è®¡åˆ’:
  â”œâ”€ åˆ—å‡ºæ‰€æœ‰å˜æ›´
  â”œâ”€ ä¼°è®¡å½±å“èŒƒå›´
  â””â”€ è¯·ç”¨æˆ·ç¡®è®¤
  â†“
ç”¨æˆ·ç¡®è®¤ â†’ æ‰§è¡Œè¿ç§»:
  â”œâ”€ å¤‡ä»½åŸæ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
  â”œâ”€ æ‰§è¡Œç»“æ„å‡çº§
  â”œâ”€ æ‰§è¡Œå†…å®¹å‡çº§
  â””â”€ ç”Ÿæˆè¿ç§»æŠ¥å‘Š
  â†“
å®Œæˆ:
  â”œâ”€ è¾“å‡ºè¿ç§»æ‘˜è¦
  â””â”€ ä¿å­˜ migration-report.md
```

## ç‰ˆæœ¬æ£€æµ‹è§„åˆ™

### ç»“æ„ç‰ˆæœ¬

| ç‰ˆæœ¬ | ç‰¹å¾ |
|------|------|
| v1 | å•æ–‡ä»¶ç»“æ„ï¼ˆworldview.mdã€characters.mdã€outline.md å„ä¸€ä¸ªï¼‰ |
| v2 | åˆ†å±‚ç»“æ„ï¼ˆæ€»è§ˆ + å­ç›®å½•è¯¦ç»†æ–‡ä»¶ï¼‰ |

### å†…å®¹ç‰ˆæœ¬

| ç‰ˆæœ¬ | ç‰¹å¾ |
|------|------|
| v1 | æ— æˆå‰§ç†è®ºå­—æ®µ |
| v2 | æœ‰æ§åˆ¶æ€æƒ³ã€åœºæ™¯ææ€§ç­‰éº¦åŸºç†è®ºå­—æ®µ |

### ç« èŠ‚å‘½åç‰ˆæœ¬

| ç‰ˆæœ¬ | æ ¼å¼ |
|------|------|
| v1 | `chapter-001.md` (3ä½) |
| v2 | `chapter-0001.md` (4ä½) |

## è¿ç§»è§„åˆ™

### ä¸–ç•Œè§‚æ‹†åˆ†

```
worldview.md (æ—§)
  â†“ æ‹†åˆ†ä¸º
worldview.md (æ–°æ€»è§ˆ)
  + worldview/power-system.md
  + worldview/factions.md
  + worldview/geography.md
  + worldview/history.md
  + worldview/rules.md
```

**æ‹†åˆ†é€»è¾‘**ï¼š
- æå–ã€ŒåŠ›é‡ä½“ç³»ã€ç›¸å…³æ®µè½ â†’ `power-system.md`
- æå–ã€ŒåŠ¿åŠ›ã€ç›¸å…³æ®µè½ â†’ `factions.md`
- æå–ã€Œåœ°ç†ã€ç›¸å…³æ®µè½ â†’ `geography.md`
- æå–ã€Œå†å²ã€ç›¸å…³æ®µè½ â†’ `history.md`
- æå–ã€Œè§„åˆ™/æ³•åˆ™ã€ç›¸å…³æ®µè½ â†’ `rules.md`
- ä¿ç•™æ¦‚è¿° + æ·»åŠ æ¨¡å—ç´¢å¼• â†’ `worldview.md`

### è§’è‰²æ‹†åˆ†

```
characters.md (æ—§)
  â†“ æ‹†åˆ†ä¸º
characters.md (æ–°æ€»è§ˆ)
  + characters/character-{ä¸»è§’}.md
  + characters/character-{å¥³ä¸»}.md
  + characters/character-{åæ´¾}.md
  + ...
```

**æ‹†åˆ†é€»è¾‘**ï¼š
- æå–æ¯ä¸ªè¯¦ç»†è§’è‰²æè¿° â†’ ç‹¬ç«‹æ¡£æ¡ˆ
- ä¿ç•™è§’è‰²åˆ—è¡¨è¡¨æ ¼ + å…³ç³»ç½‘ â†’ `characters.md`
- æ–°å¢å¯¹æŠ—åŠ›é‡è®¾è®¡ç« èŠ‚

### å¤§çº²æ‹†åˆ†

```
outline.md (æ—§)
  â†“ æ‹†åˆ†ä¸º
outline.md (æ–°æ¡†æ¶)
  + outlines/vol-1.md
  + outlines/vol-2.md
  + ...
```

**æ‹†åˆ†é€»è¾‘**ï¼š
- æŒ‰å·/é˜¶æ®µæ‹†åˆ†ç« èŠ‚åˆ—è¡¨
- ä¿ç•™æ•´ä½“æ¡†æ¶ + æ·»åŠ æˆå‰§ç»“æ„ â†’ `outline.md`
- å„å·è¯¦ç»†ç« èŠ‚ + æ·»åŠ åœºæ™¯ææ€§ â†’ `outlines/vol-*.md`

### ç« èŠ‚é‡å‘½å

```
chapter-001.md â†’ chapter-0001.md
chapter-002.md â†’ chapter-0002.md
...
chapter-999.md â†’ chapter-0999.md
```

**åŒæ—¶æ›´æ–°**ï¼š
- ç« èŠ‚å†…çš„ YAML frontmatter
- `entities.md` ä¸­çš„ç« èŠ‚å¼•ç”¨
- `progress.md` ä¸­çš„ç« èŠ‚å¼•ç”¨ï¼ˆå¦‚æœ‰ï¼‰

## è¾“å‡ºç¤ºä¾‹

### è¿ç§»è®¡åˆ’ï¼ˆ--dry-runï¼‰

```
ğŸ“‹ é¡¹ç›®è¿ç§»è®¡åˆ’: xuanhuan_001
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š å½“å‰ç‰ˆæœ¬æ£€æµ‹:
  ç»“æ„ç‰ˆæœ¬: v1 (å•æ–‡ä»¶)
  å†…å®¹ç‰ˆæœ¬: v1 (æ— æˆå‰§ç†è®º)
  ç« èŠ‚å‘½å: v1 (3ä½æ•°)

ğŸ“¦ è®¡åˆ’å˜æ›´:

ã€ç»“æ„å‡çº§ã€‘
  worldview.md â†’ worldview.md + worldview/
    + power-system.md (ä»åŸæ–‡æå–)
    + factions.md (ä»åŸæ–‡æå–)
    + geography.md (ä»åŸæ–‡æå–)
    + history.md (æ–°å»ºæ¨¡æ¿)
    + rules.md (æ–°å»ºæ¨¡æ¿)

  characters.md â†’ characters.md + characters/
    + character-è§ç‚.md (ä»åŸæ–‡æå–)
    + character-è§è–°å„¿.md (ä»åŸæ–‡æå–)
    + character-äº‘éŸµ.md (ä»åŸæ–‡æå–)

  outline.md â†’ outline.md + outlines/
    + vol-1.md (ç¬¬1-40ç« )
    + vol-2.md (ç¬¬41-80ç« )
    + vol-3.md (ç¬¬81-120ç« )

ã€ç« èŠ‚é‡å‘½åã€‘
  chapter-001.md â†’ chapter-0001.md
  chapter-002.md â†’ chapter-0002.md
  ... (å…± 120 ä¸ªæ–‡ä»¶)

ã€å†…å®¹å‡çº§ã€‘
  outline.md:
    + æ§åˆ¶æ€æƒ³ (éœ€æ‰‹åŠ¨å¡«å†™)
    + äº”å¤§å‘½è¿è½¬æŠ˜ç‚¹ (éœ€æ‰‹åŠ¨å¡«å†™)
    + é€’è¿›å‹åŠ›é“¾ (éœ€æ‰‹åŠ¨å¡«å†™)

  characters.md:
    + å¯¹æŠ—åŠ›é‡è®¾è®¡ (éœ€æ‰‹åŠ¨å¡«å†™)

  worldview.md:
    + å†²çªå±‚æ¬¡æ¡†æ¶ (éœ€æ‰‹åŠ¨å¡«å†™)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å½±å“æ–‡ä»¶: 156 ä¸ª
é¢„è®¡è€—æ—¶: 2-3 åˆ†é’Ÿ

ç¡®è®¤æ‰§è¡Œè¿ç§»? [Y/n]
```

### è¿ç§»å®Œæˆ

```
âœ… é¡¹ç›®è¿ç§»å®Œæˆ: xuanhuan_001
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š å‡çº§ç»“æœ:
  ç»“æ„ç‰ˆæœ¬: v1 â†’ v2 âœ“
  å†…å®¹ç‰ˆæœ¬: v1 â†’ v2 âœ“
  ç« èŠ‚å‘½å: v1 â†’ v2 âœ“

ğŸ“¦ å˜æ›´ç»Ÿè®¡:
  æ–°å»ºç›®å½•: 3 ä¸ª
  æ–°å»ºæ–‡ä»¶: 12 ä¸ª
  ä¿®æ”¹æ–‡ä»¶: 8 ä¸ª
  é‡å‘½åæ–‡ä»¶: 120 ä¸ª

ğŸ“ è¿ç§»æŠ¥å‘Šå·²ä¿å­˜:
  releases/xuanhuan_001/reviews/migration-report.md

âš ï¸ éœ€è¦æ‰‹åŠ¨å®Œå–„:
  1. outline.md - å¡«å†™æ§åˆ¶æ€æƒ³
  2. outline.md - å¡«å†™äº”å¤§å‘½è¿è½¬æŠ˜ç‚¹
  3. outlines/vol-*.md - å¡«å†™åœºæ™¯ææ€§
  4. characters/*.md - å¡«å†™åŒå±‚æ¬²æœ›
  5. worldview.md - å¡«å†™å†²çªå±‚æ¬¡

ğŸ’¡ æç¤º:
  ä½¿ç”¨è‡ªç„¶è¯­è¨€è¡¥å……ï¼Œå¦‚ï¼š
  "å¸®æˆ‘è¡¥å…… outline.md çš„æ§åˆ¶æ€æƒ³"
  "å¸®æˆ‘è®¾è®¡ä¸»è§’çš„åŒå±‚æ¬²æœ›"
```

## Git å¤‡ä»½ä¸å›æ»š

è¿ç§»ä½¿ç”¨ Git è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œç¡®ä¿å¯é çš„å¤‡ä»½å’Œå›æ»šã€‚

### å‰ç½®è¦æ±‚

- **Git**: å¦‚æœªå®‰è£…ï¼Œè¿ç§»æ—¶ä¼šè‡ªåŠ¨å®‰è£…
  - macOS: `xcode-select --install` æˆ– `brew install git`
  - Linux: `apt-get install git` æˆ– `yum install git`

### è¿ç§»æµç¨‹

1. æ£€æŸ¥ Git ç¯å¢ƒï¼ˆè‡ªåŠ¨å®‰è£…å¦‚ç¼ºå¤±ï¼‰
2. è¿ç§»å‰è‡ªåŠ¨æäº¤ï¼š`backup: è¿ç§»å‰å¤‡ä»½`
3. æ‰§è¡Œè¿ç§»æ“ä½œ
4. è¿ç§»åè‡ªåŠ¨æäº¤ï¼š`migrate: å‡çº§ {project_id} åˆ° v2 ç»“æ„`

### å›æ»šæ–¹æ³•

```bash
# æŸ¥çœ‹æäº¤å†å²
git log --oneline

# æ–¹æ³•1: æ’¤é”€è¿ç§»ï¼ˆä¿ç•™å†å²ï¼‰
git revert HEAD

# æ–¹æ³•2: ç¡¬å›æ»šï¼ˆä¸¢å¼ƒè¿ç§»ï¼‰
git reset --hard HEAD~1
```

## æ³¨æ„äº‹é¡¹

1. **å…ˆå¤‡ä»½**: å»ºè®®æ‰§è¡Œå‰æ‰‹åŠ¨ `git commit` ä¿å­˜å½“å‰çŠ¶æ€
2. **æ¸è¿›å‡çº§**: å¯ä»¥å…ˆ `--dry-run` é¢„è§ˆï¼Œå†å†³å®šæ˜¯å¦æ‰§è¡Œ
3. **æ‰‹åŠ¨è¡¥å……**: æˆå‰§ç†è®ºå­—æ®µéœ€è¦äººå·¥æ€è€ƒå¡«å†™ï¼Œè¿ç§»åªåˆ›å»ºæ¨¡æ¿
4. **ç« èŠ‚å†…å®¹ä¸å˜**: åªæ”¹ç»“æ„å’Œå…ƒæ•°æ®ï¼Œä¸ä¿®æ”¹æ­£æ–‡å†…å®¹

## ç›¸å…³å‘½ä»¤

- `/nw-init` - åˆå§‹åŒ–å·¥ä½œåŒº
- `/nw-bp-plan` - ç”Ÿæˆè“å›¾
- `/nw-bp-audit` - å®¡æ ¸è“å›¾
