---
name: nw-check-entities
description: 检查实体库一致性，发现冲突和问题
---

# /nw-check-entities

检查指定项目的实体库，发现重复、冲突和潜在问题。

## 用法

```
/nw-check-entities {project_id}
```

## 执行流程

调用 `entity-manager` Agent 执行以下检查：

### 1. 重复检测

检查 `entities.md` 中是否有：
- 标准名称重复
- 同一实体ID出现多次

### 2. 冲突检测

检查是否有：
- 别名与其他实体的标准名称冲突
- 同一别名属于多个实体

### 3. 相似度检测

使用编辑距离算法检查：
- 拼写相似的实体（可能是笔误）
- 同音不同字的实体

### 4. 章节扫描

扫描所有章节，检查：
- 未注册的实体名称
- 实体首次出现章节是否正确

## 输出示例

```
🔍 实体检查: dao_immortal

实体总数: 46 个
  - 角色: 28
  - 地点: 15
  - 物品: 9

检查结果:

⚠️ 发现 2 处问题

1. 重复实体
   char_005 和 char_018 都叫 "李青云"
   建议: 合并或改名

2. 相似名称
   "云霄宗" (place_003) 与 "云霄峰" (place_008) 相似
   建议: 确认是否为不同地点

✅ 无别名冲突
✅ 无未注册实体

修复建议:
  - 全局替换: "将'李青云'改为'李清云'"
  - 合并实体: "合并 char_005 和 char_018"
```

## 相关命令

- `/nw-status` - 查看项目状态
- `/nw-list` - 列出所有项目

## 相关 Agent

- `entity-manager` - 执行实际检查和修复操作
