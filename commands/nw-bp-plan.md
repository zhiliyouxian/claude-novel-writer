---
name: nw-bp-plan
description: 生成蓝图（策划阶段）。用法: /nw-bp-plan [pool_name] <类型> <流派>。支持渐进式策划、灵活规模。
---

# 蓝图生成命令

生成小说蓝图，包括选题方案、世界观、角色档案和章节大纲。

**核心理念**：融合**麦基戏剧理论**（控制思想、五大转折点、场景极性）与**网文技法**（爽点、钩子、境界曲线）。

执行此命令后进入**蓝图阶段**，后续对话可直接讨论蓝图修改，无需重复输入命令。

## 阶段职责分工

| 阶段 | 职责 | 产出 |
|------|------|------|
| **蓝图阶段** | 详细规划 | 世界观、角色、大纲、戏剧结构 |
| **创作阶段** | 展开润色 | 根据蓝图展开内容，润色文字 |

- **蓝图阶段**：完成所有规划工作，包括情节设计、角色塑造、冲突设置、戏剧结构
- **创作阶段**：根据蓝图展开具体内容，负责文字润色、节奏把控、细节填充

> 蓝图越详细，创作越顺畅。创作阶段不应大幅修改情节走向。

## 灵活模式

### 规模灵活
支持任意规模的小说创作：

| 规模 | 章节数 | 适用场景 |
|------|--------|----------|
| 单章 | 1章 | 短篇故事、番外 |
| 短篇 | 3-10章 | 短篇小说、试写 |
| 中篇 | 20-50章 | 中篇连载 |
| 长篇 | 100-300章 | 标准网文 |
| 超长篇 | 500+章 | 无限连载 |

**不限制章节数**：用户可自由指定，系统自动适配卷划分和节奏。

### 渐进式策划
支持「边策划边创作」的工作流：

```
策划第一卷 → 创作第一卷 → 策划第二卷 → 创作第二卷 → ...
```

无需一次性完成全部蓝图，可以：
1. 先生成总览（世界观、角色、大纲框架）
2. 细化当前卷 → 创作当前卷
3. 根据创作情况调整后续卷的规划
4. 重复以上过程

### 自然语言引导
如果信息不完整，通过对话澄清：

```
用户: "我想写个修仙小说"

Claude: 好的，为了生成更合适的蓝图，我有几个问题：

1. 规模打算多大？
   - 短篇（10章左右）
   - 中篇（50章左右）
   - 长篇（200章以上）
   - 无限连载（边写边规划）

2. 主角有什么特别的金手指或设定吗？

3. 希望是什么风格？
   - 爽文快节奏
   - 剧情流
   - 轻松搞笑
   - ...
```

## 用法

```bash
/nw-bp-plan [pool_name] <类型> <流派>
```

## 示例

```bash
# 基于素材池生成蓝图
/nw-bp-plan xuanhuan_1 玄幻 废柴流

# 不使用素材池，直接生成
/nw-bp-plan 玄幻 系统流

# 指定更多关键词
/nw-bp-plan 都市 重生 复仇

# 英文关键词也支持
/nw-bp-plan fantasy hero's-journey
```

## 参数说明

| 参数 | 必填 | 说明 |
|------|------|------|
| pool_name | 可选 | 素材池名称，用于参考风格 |
| 类型 | 必填 | 题材类型（玄幻/仙侠/都市/科幻等） |
| 流派 | 必填 | 流派关键词（废柴流/系统流/重生等） |

## 功能

此命令会依次调用 4 个 Agent 生成**分层蓝图**，融合麦基戏剧理论：

### 阶段一：生成总览文件（必需）

1. **选题方案** (proposal.md)
   - 3 个备选方案
   - 每个方案包含：核心设定、金手指、阶段划分
   - **规模灵活**：根据用户需求调整章节数

2. **世界观总览** (worldview.md)
   - 世界背景概述
   - 力量体系概述（境界列表）
   - 势力格局概述
   - 地理概述
   - 金手指设定
   - 模块索引（引用详细模块）
   - **冲突层次框架**（麦基理论：内心→人际→社会→存在）

3. **角色总览** (characters.md)
   - 角色列表表格
   - 关系网图
   - 阵营划分
   - **对抗力量设计**（麦基���论：力量配比、对抗金字塔）
   - 待细化角色列表

4. **大纲框架** (outline.md)
   - 全书概述（总章数、卷数）
   - **控制思想**（麦基理论：「价值+因为原因」）
   - **五大命运转折点**（激励事件→终极高潮）
   - **递进压力链**（压力递增，不可倒退）
   - 卷/阶段划分
   - 关键节点（高潮、转折）
   - 主角成长曲线
   - 伏笔规划

### 阶段二：按需细化（可选）

用户可通过自然语言指令细化各模块：

| 指令 | 生成文件 | 包含内容 |
|------|----------|----------|
| "细化力量体系" | worldview/power-system.md | 境界、突破、战力 |
| "细化势力" | worldview/factions.md | 势力详情、关系 |
| "细化地理" | worldview/geography.md | 地图、场景 |
| "细化历史" | worldview/history.md | 时间线、秘辛 |
| "细化规则" | worldview/rules.md | 天道、禁忌 |
| "细化{角色名}" | characters/character-{角色名}.md | **双层欲望、压力人格、蜕变轨迹** |
| "细化第一卷" | outlines/vol-1.md | **场景极性、节拍设计、抉择设计** |

### 渐进式工作流

**推荐流程**（边策划边创作）：

```
┌─────────────────────────────────────────────────────────┐
│  第一轮：完成总览 + 细化第一卷 + 创作第一卷            │
├─────────────────────────────────────────────────────────┤
│  1. /nw-bp-plan 玄幻 废柴流                             │
│     → 生成 proposal.md, worldview.md, characters.md,   │
│       outline.md（总览）                                │
│                                                         │
│  2. "细化第一卷"                                        │
│     → 生成 outlines/vol-1.md（含戏剧结构）             │
│                                                         │
│  3. /nw-ch-write 1-40                                   │
│     → 创作第一卷章节                                    │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  第二轮：根据创作情况调整 + 细化第二卷 + 创作第二卷    │
├─────────────────────────────────────────────────────────┤
│  4. 回顾第一卷，必要时调整 outline.md                   │
│                                                         │
│  5. "细化第二卷"                                        │
│     → 生成 outlines/vol-2.md                           │
│                                                         │
│  6. /nw-ch-write 41-80                                  │
│     → 创作第二卷章节                                    │
└─────────────────────────────────────────────────────────┘
                          ↓
                        循环...
```

**优势**：
- 不需要一次规划数百章
- 可以根据创作反馈调整后续情节
- 适合无限连载、边写边改的模式

## 执行流程

```
用户输入: /nw-bp-plan xuanhuan_1 玄幻 废柴流
  ↓
信息完整性检查:
  ├─ 信息完整 → 继续
  └─ 信息不足 → 自然语言引导澄清（见下方）
  ↓
确定规模和节奏:
  ├─ 用户指定章节数 → 使用指定值
  ├─ 用户指定规模类型 → 推断章节数
  └─ 未指定 → 询问或默认"长篇200章"
  ↓
确定 project_id:
  ├─ 如果用户指定项目名 → 使用指定名
  └─ 否则 → 自动生成（如 xuanhuan_001）
  ↓
读取参考风格（可选）:
  pools/analysis/xuanhuan_1/style-fusion.md
  ↓
加载知识库:
  ├─ libraries/knowledge/_base/ (通用知识 + 麦基理论)
  └─ libraries/knowledge/chinese-webnovel/ (匹配"玄幻")
  ↓
调用 Agents（阶段一：生成总览）:
  1. 生成选题方案 → blueprints/{project_id}/proposal.md
  2. 用户选择方案（或自动选择方案1）
  3. 生成世界观总览 → blueprints/{project_id}/worldview.md（含冲突框架）
  4. 生成角色总览 → blueprints/{project_id}/characters.md（含对抗力量）
  5. 生成大纲框架 → blueprints/{project_id}/outline.md（含控制思想、五大转折点）
  6. 创建子目录 → worldview/, characters/, outlines/
  ↓
完成阶段一:
  ├─ 输出蓝图摘要
  └─ 提示可选的细化操作
  ↓
用户按需细化（阶段二，可选）:
  ├─ "细化力量体系" → worldview/power-system.md
  ├─ "细化主角" → characters/character-{主角名}.md（含双层欲望）
  └─ "细化第一卷" → outlines/vol-1.md（含场景极性、节拍）
```

### 自然语言引导流程

当信息不完整时，通过对话澄清：

```
场景1: 缺少规模信息

用户: "我想写个玄幻小说"

Claude: 好的！我来帮你规划玄幻小说。先确认几个问题：

📏 规模打算多大？
  1. 短篇（~10章，试水/番外）
  2. 中篇（~50章，完整小故事）
  3. 长篇（~200章，标准网文）
  4. 无限连载（边写边规划）

🎯 主角有什么特别的金手指吗？
  （如：签到系统、重生、神级天赋...）

⚡ 希望什么风格？
  （爽文快节奏 / 剧情流 / 轻松搞笑...）
```

```
场景2: 缺少核心设定

用户: "/nw-bp-plan 都市"

Claude: 都市题材有很多方向，帮我确认一下：

🏷️ 流派偏好？
  1. 重生复仇
  2. 神豪系统
  3. 异能觉醒
  4. 职场逆袭
  5. 其他（请描述）

🎭 主角起点？
  1. 底层逆袭
  2. 隐藏大佬
  3. 普通人获得金手指

📊 预计规模？（可以后续调整）
```

```
场景3: 渐进式规划

用户: "先写第一卷试试"

Claude: 好的，我们采用渐进式规划：

1. 现在生成：
   - 世界观总览（大框架）
   - 角色总览（主要角色）
   - 大纲框架（整体方向）
   - 第一卷详细大纲

2. 第一卷创作完成后，再细化第二卷

这样可以根据创作反馈调整后续情节。

要确认规模吗？还是先按"长篇"来规划整体框架？
```

## 输出示例

```
开始生成蓝图: 玄幻 废柴流
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 项目信息
  project_id: xuanhuan_001
  参考风格: pools/analysis/xuanhuan_1/style-fusion.md
  知识库: _base + chinese-webnovel

📝 [1/4] 生成选题方案...
  ✓ 方案1: 《万古签到系统》- 签到流 + 废柴逆袭
  ✓ 方案2: 《吞噬星空》- 异能觉醒 + 宇宙探索
  ✓ 方案3: 《一念永恒》- 废柴流 + 搞笑风格

  已自动选择: 方案1

🌍 [2/4] 生成世界观总览...
  ✓ 力量体系: 炼气→筑基→金丹→元婴→化神→大乘→渡劫
  ✓ 势力格局: 3宗5派 + 世家 + 魔门
  ✓ 地理设定: 东玄域 → 中州 → 天外天
  → 详细模块待细化: worldview/

👥 [3/4] 生成角色总览...
  ✓ 主角: 萧羽 (废柴少年，签到系统)
  ✓ 女主: 柳如烟、云瑶 (2人)
  ✓ 反派: 李傲天、云家老祖、魔帝 (5人)
  ✓ 配角: 15人
  → 详细档案待细化: characters/

📖 [4/4] 生成大纲框架...
  ✓ 第一卷: 1-40章 (崛起之路)
  ✓ 第二卷: 41-80章 (磨练成长)
  ✓ 第三卷: 81-120章 (三年之约)
  ✓ 第四卷: 121-170章 (中州争锋)
  ✓ 第五卷: 171-210章 (巅峰对决)
  → 分卷大纲待细化: outlines/

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 蓝图总览生成完成!

蓝图位置:
blueprints/xuanhuan_001/
├─ proposal.md      # 选题方案
├─ worldview.md     # 世界观总览
├─ characters.md    # 角色总览
├─ outline.md       # 大纲框架（5卷/210章）
├─ worldview/       # 世界观模块（待细化）
├─ characters/      # 角色档案（待细化）
└─ outlines/        # 分卷大纲（待细化）

下一步:
1. 按需细化模块:
   - "细化力量体系" → worldview/power-system.md
   - "细化主角" → characters/character-萧羽.md
   - "细化第一卷" → outlines/vol-1.md
2. 审核蓝图: /nw-bp-audit
3. 开始创作: /nw-ch-write 1-10 （建议先细化第一卷）
```

## 交互模式

### 选择方案

默认自动选择方案1，也可以交互选择：

```
📝 生成了3个选题方案:

方案1: 《万古签到系统》
  签到流 + 废柴逆袭，节奏快，爽点密集

方案2: 《吞噬星空》
  异能觉醒 + 宇宙探索，格局大，世界观宏大

方案3: 《一念永恒》
  废柴流 + 搞笑风格，轻松向，适合轻松阅读

选择方案 [1/2/3]:
```

### 指定项目名

```bash
# 自动生成 project_id
/nw-bp-plan 玄幻 废柴流
# → project_id: xuanhuan_001

# 指定项目名
"创作《纵横天下》玄幻小说"
# → project_id: zongheng
```

## 错误处理

### 错误1: 缺少类型参数

```
错误: 请指定小说类型和流派
用法: /nw-bp-plan [pool_name] <类型> <流派>
示例: /nw-bp-plan 玄幻 废柴流
```

### 错误2: 素材池不存在

```
警告: pools/xuanhuan_1 不存在
将不使用参考风格，基于知识库生成蓝图

继续? [Y/n]
```

### 错误3: 蓝图已存在

```
警告: blueprints/xuanhuan_001 已存在
选项:
  [1] 覆盖现有蓝图
  [2] 使用新 project_id (xuanhuan_002)
  [3] 取消
```

## 知识库匹配

根据关键词自动加载对应知识库：

| 关键词 | 加载知识库 |
|--------|-----------|
| 玄幻/网文/修仙/系统流 | chinese-webnovel/ |
| 异世界/轻小说/转生 | japanese-lightnovel/ |
| fantasy/epic/magic | western-fantasy/ |

## 注意事项

1. **素材可选**：没有参考素材也可以生成蓝图
2. **可编辑**：生成后可手动调整任何蓝图文件
3. **增量生成**：可以单独重新生成某个部分（如只重新生成大纲）
4. **知识驱动**：质量取决于知识库的丰富程度

## 相关命令

- `/nw-scan` - 扫描分析素材池（可选前置步骤）
- `/nw-bp-audit` - 审核蓝图质量
- `/nw-ch-write` - 批量创作章节

---

**提示**: 执行此命令后进入蓝图阶段，可直接通过对话修改蓝图内容，无需重复输入命令。
