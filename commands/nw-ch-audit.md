---
name: nw-ch-audit
description: 审核章节质量（创作阶段）。用法: /nw-ch-audit 1-10
---

# 批量章节审核命令

快捷批量审核多个章节的命令。

## 用法

```bash
/nw-ch-audit <章节范围或列表>
```

## 示例

```bash
# 审核第1-10章(连续范围)
/nw-ch-audit 1-10

# 审核指定章节(离散列表)
/nw-ch-audit 1,4,7

# 审核单章
/nw-ch-audit 5

# 审核后半部分
/nw-ch-audit 101-200
```

## 功能

此命令会:

1. **解析参数**: 支持范围(1-10)或列表(1,4,7)格式
2. **调用Agent**: 调用 `chapter-auditor` Agent执行审核
3. **逐章评分**: 从五个维度评估每章质量
4. **生成报告**: 输出详细审核报告到reviews目录
5. **汇总建议**: 提供优先级修改建议

## 执行流程

```
用户输入: /nw-ch-audit 1-10
  ↓
解析: 起始=1, 结束=10, 共10章
  ↓
【前置】调用 encoding-checker Skill:
  扫描: productions/{project_id}/chapters/chapter-*.md
  ├─ 无乱码 → 继续审核
  └─ 有乱码 → 自动修复 → 再次检查 → 循环直到无乱码 → 继续审核
  ↓
读取素材池融合风格(style-fusion.md):
  ├─ 目标句长: 15.6字
  ├─ 目标对话比例: 43%
  └─ 目标爽点密度: 3.3/千字
  ↓
For each 章节 from 1 to 10:
  ├─ 读取 productions/{project_id}/chapters/chapter-{N}.md
  ├─ 统计基础数据(字数/句长/对话比例)
  ├─ 分析爽点(关键词/密度/分布)
  ├─ 评估对话(自然度/性格/推动剧情)
  ├─ 检查钩子(类型/吸引力)
  ├─ 评估节奏(起承转合)
  ├─ 计算综合评分
  └─ 显示进度: "已审核 {N}/10 章"
  ↓
全部完成后:
  ├─ 生成批次报告
  ├─ 汇总问题清单
  ├─ 计算平均分
  └─ 提示修改建议
```

## 审核维度

### 1. 风格一致性 (权重20%)

检查内容:
- 平均句长与目标偏差
- 对话比例与目标偏差
- 叙事视角统一性

评分标准:
- 10分: 完全符合目标(偏差<5%)
- 8分: 基本符合(偏差5-10%)
- 6分: 有偏差(偏差10-20%)
- 4分: 偏差较大(偏差20-30%)
- 2分: 严重偏离(偏差>30%)

### 2. 爽点密度 (权重30%)

检查内容:
- 爽点关键词数量
- 爽点分布均匀度
- 爽点类型多样性

爽点关键词:
- **战斗类**: 碾压、秒杀、轰飞、击败、完胜
- **突破类**: 突破、晋级、进阶、凝聚、圆满
- **震惊类**: 震惊、骇然、惊呆、不可思议、难以置信
- **暴露类**: 原来、竟然、居然、没想到、真相
- **获得类**: 得到、获得、发现、宝物、机缘

评分标准:
- 10分: 密度3.5-4.0/千字
- 8分: 密度3.0-3.4/千字
- 6分: 密度2.5-2.9/千字
- 4分: 密度2.0-2.4/千字
- 2分: 密度<2.0/千字

### 3. 对话质量 (权重20%)

检查内容:
- 对话自然度(口语化程度)
- 角色性格一致性
- 对话推动剧情

评分标准:
- 10分: 自然+性格一致+推动剧情
- 8分: 基本符合,1-2处小问题
- 6分: 有3-5处问题
- 4分: 问题较多,>5处
- 2分: 严重不符合角色性格

### 4. 章节钩子 (权重15%)

检查内容:
- 章末悬念设置
- 钩子类型分类
- 吸引力评估

钩子类型:
- **悬念型**: "就在...时" (推荐占比40-45%)
- **冲突型**: 杀意/冷笑/对峙 (推荐占比30-35%)
- **预告型**: "他不知道" (推荐占比15%)
- **反转型**: 意外发生 (推荐占比10%)

评分标准:
- 10分: 强悬念+多重吸引
- 8分: 有效悬念或冲突
- 6分: 普通结尾,有一定吸引
- 4分: 结尾平淡
- 2分: 无钩子

### 5. 节奏把控 (权重15%)

检查内容:
- 章节结构(起承转合)
- 张弛有度
- 段落衔接

评分标准:
- 10分: 起承转合完美
- 8分: 节奏合理
- 6分: 略有拖沓或仓促
- 4分: 节奏问题明显
- 2分: 节奏混乱

## 评分计算

```
总分 = 风格×0.2 + 爽点×0.3 + 对话×0.2 + 钩子×0.15 + 节奏×0.15
```

### 评级标准

| 评分 | 评级 | 建议 |
|------|------|------|
| 8.5+ | ✅ 优秀 | 无需修改 |
| 7.5-8.4 | ✅ 通过 | 可选优化 |
| 7.0-7.4 | ⚠️ 需修改 | 建议修正 |
| <7.0 | ❌ 需重写 | 必须修改 |

## 输出示例

### 通过状态

```
开始批量审核: 第1-10章
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【编码检查】
检测 10 个文件... ✅ 全部正常

[1/10] 审核 第1章 废柴少年...
  风格: 8/10  爽点: 6/10  对话: 8/10  钩子: 8/10  节奏: 8/10
  总分: 7.5/10 ⚠️ 需修改
  问题: 爽点密度偏低(2.2/千字)

[2/10] 审核 第2章 {章节标题2}...
  风格: 8/10  爽点: 7/10  对话: 8/10  钩子: 9/10  节奏: 8/10
  总分: 8.0/10 ✅ 通过

...

[10/10] 审核 第10章 外门大比...
  风格: 8/10  爽点: 8/10  对话: 8/10  钩子: 9/10  节奏: 8/10
  总分: 8.1/10 ✅ 优秀

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 批量审核完成!

审核统计:
- 审核章节: 10章
- 平均分: 7.76/10

评级分布:
- ✅ 优秀 (8.5+): 2章 (20%)
- ✅ 通过 (7.5-8.4): 6章 (60%)
- ⚠️ 需修改 (7.0-7.4): 2章 (20%)
- ❌ 需重写 (<7.0): 0章 (0%)

问题汇总:
1. chapter-001: 爽点密度偏低(2.2/千字)
2. chapter-004: 角色性格不一致(第234行)
3. chapter-007: 对话比例偏低(28%)

报告位置:
releases/{project_id}/reviews/batch-001-010-report.md

下一步建议:
1. 修正问题章节: /nw-ch-write --revise 1,4,7
2. 修正后重新审核: /nw-ch-audit 1,4,7
3. 通过后继续创作: /nw-ch-write 11-20
```

### 发现乱码状态

```
开始批量审核: 第1-10章
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【编码检查】
❌ chapter-0003.md (5 个错误)
   第15行: ...不像��渎那样锋利...
   第187行: 我深吸一口���，正要开口——

❌ chapter-0007.md (2 个错误)
   第59行: ...但���住，不要暴露...

============================================================
检测完成: 10 个文件
  ✅ 正常: 8
  ❌ 问题: 2
  📍 总错误数: 7

⚠️ 发现编码问题，需先修复再审核

建议:
1. 根据上下文修复乱码（如 "一口���" → "一口气"）
2. 修复后重新运行: /nw-ch-audit 1-10
```

### 有问题状态

```
⚠️ 批量审核发现严重问题

审核范围: 1-10章
平均分: 6.8/10

严重问题 (需立即修正):
- chapter-003: 质量不达标 (6.2/10) ❌
- chapter-007: 爽点严重偏低 (1.5/千字) ❌
- chapter-009: 节奏混乱,结构不清 ❌

建议:
1. 重写严重问题章节: /nw-ch-write --revise 3,7,9
2. 修正后重新审核: /nw-ch-audit 3,7,9
3. 通过后再继续创作

详细报告: releases/{project_id}/reviews/batch-001-010-report.md
```

## 参数验证

### 有效格式

```bash
/nw-ch-audit 1-10      # 连续范围
/nw-ch-audit 1,4,7     # 离散列表
/nw-ch-audit 5         # 单个章节
/nw-ch-audit 101-200   # 大范围
```

### 错误处理

#### 错误1: 章节不存在

```
错误: chapter-0015.md 不存在
建议: 请先创作第15章,使用 /nw-ch-write 15
```

#### 错误2: 范围无效

```
错误: 起始章节(20)大于结束章节(10)
建议: 正确格式为 /nw-ch-audit 10-20
```

#### 错误3: 缺少风格参考

```
警告: 未找到素材池融合风格文件
使用默认参数:
- 默认句长: 15字
- 默认对话比例: 40%
- 默认爽点密度: 3.0/千字

建议: 先运行素材分析建立风格基准
```

## 最佳实践

### 建议1: 每批10章审核

```bash
# 推荐: 每批10章,便于管理和修改
/nw-ch-write 1-10
/nw-ch-audit 1-10
# 修正问题
/nw-ch-write 11-20
/nw-ch-audit 11-20
```

### 建议2: 审核后及时修改

```bash
/nw-ch-audit 1-10
# 查看报告,发现问题
/nw-ch-write --revise 1,4,7  # 修订问题章节
/nw-ch-audit 1,4,7           # 重新审核确认
```

### 建议3: 定期全量审核

```bash
# 每50章做一次全量审核
/nw-ch-audit 1-50
# 检查风格漂移和一致性问题
```

## 报告结构

生成的审核报告包含:

```markdown
# 章节批次审核报告

## 基本信息
- 项目: xxx
- 审核范围: chapter-001 ~ chapter-010
- 审核时间: 2023-11-13 16:30

## 整体评分表
| 章节 | 总分 | 风格 | 爽点 | 对话 | 钩子 | 节奏 | 状态 |
|------|------|------|------|------|------|------|------|
| ... | ... | ... | ... | ... | ... | ... | ... |

## 问题汇总
### 严重问题 (P0)
### 建议修改 (P1)
### 可选优化 (P2)

## 风格一致性分析
### 句长分布
### 对话比例
### 爽点密度

## 钩子类型统计
## 修改建议
## 下一步操作
```

## 与其他组件协作

### 被调用

- **用户直接调用**: `/nw-ch-audit {range}`

### 调用

- **chapter-auditor Agent**: 执行实际审核逻辑

### 后续操作

- **nw-ch-write --revise**: 根据审核结果修订章节
- **nw-ch-write**: 审核通过后继续创作
- **nw-release**: 全部通过后导出发布

## 相关命令

- `/nw-ch-write 1-10` - 批量创作章节
- `/nw-release` - 导出发布

---

**提示**: 审核是质量保证的关键环节,建议每批创作后都进行审核,及时发现和修正问题。
